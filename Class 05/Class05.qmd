---
title: "Class 5: Data Viz with ggplot"
author: "Kimberly Navarro (A17485724)"
format: pdf
toc: true
---

## Background

There are lot's of ways to make plots in R. These include so-called "base R" (like the 'plot()') and add on packages like **ggplot2**

Lets make the same plot with these two graphics systems. We can use the inbuilt 'cars' dataset: 

```{r}
head(cars)
```

With "base R" we can simply:
```{r}
plot (cars)
```

Now lets try ggplot. First I need to install the package using `install.packages("ggplot2")`

> **N.B.** We newver run on an 'install.packages()' in a code chunk otherwise we will re-install needlessly everytime we render our document.

Every time we want to use an add on package we need to load it up with a call to `library()` 

install.packages("ggplot2")

```{r}
library(ggplot2)
ggplot(cars)
```
Every ggplot needs at least 3 things:
1. The **data** i.e. stuff to plot as a data.frame
2. The **aes** or aesthetics that map the data to the plot
3. The **geom** or geometry i.e. the plot type such as plots, lines, etc

```{r}
ggplot(cars)+
  aes(x=speed, y=dist) +
  geom_point()+
  geom_line()
```
```{r}
ggplot(cars) +
  aes(x=speed, y=dist) +
  geom_point() +
  geom_smooth(method= "lm", se= FALSE) +
  labs (x="Speed (MPH)",
        y="Distance (ft)",
        title="Stopping Distance of old Cars") +
  theme_bw()
```






## Gene Expression Plot

Read some data on the effectes of GLP-1 inhibitor (drug) on gene expression values:
```{r}
url <- "https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt"
genes <- read.delim(url)
head(genes)
```

Version 1 plot - start simple by getting some ink on the same page.

```{r}
ggplot(genes) +
  aes(x=Condition1, y=Condition2) +
  geom_point(col="blue", alpha= 0.2)
```

Let's color by `State` up, down or no change.
```{r}
table(genes$State)
```
```{r}
ggplot(genes) +
  aes(x=Condition1, y=Condition2, col=State) +
  geom_point() + 
  scale_color_manual(values= c("purple", "gray", "orange")) + 
  labs(x="Control (no drug",
       y="Drug",
       title= "Expression changes with GLP-1 drug")
```

## Going further with gapmider 

Here we explore the famous `gapmider` dataset with some custom plots

```{r}
# File location online
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"

gapminder <- read.delim(url)
head(gapminder)
```

> Q. How many roes does this dataset have?

```{r}
nrow(gapminder)
```

> How many different contients are in this dataset?

```{r}
table(gapminder$continent)
```

Version 1 plot gdpPercap vs. LifeExp for all rows

```{r}
ggplot(gapminder)+
  aes(gdpPercap, lifeExp, col=continent) +
  geom_point() +
  scale_color_manual(values= c("red", "blue", "purple", "magenta", "orange"))
```

I want to see a plot for each continent- in ggplot lingo this is called "faceting"

```{r}
ggplot(gapminder)+
  aes(gdpPercap, lifeExp, col=continent) +
  geom_point() +
  scale_color_manual(values= c("red", "blue", "purple", "magenta", "orange")) +
  facet_wrap(~continent)
```

## First look at the dplyr package

Another add-on package with a function called `filter()` that we want to use.

install.packages("dplyr")

```{r}
library(dplyr)
```

```{r}
filter(gapminder, year== 2007, country=="Ireland")
```

```{r}
input <- filter(gapminder, year == 2007 | year == 1977)
```

```{r}
ggplot(input)+
  aes(gdpPercap, lifeExp, col=continent) +
  geom_point() +
  scale_color_manual(values= c("red", "blue", "purple", "magenta", "orange")) +
  facet_wrap(~year)
```

